{"ast":null,"code":"import _asyncToGenerator from \"C:/Users/Asus/Desktop/Tomato/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { Tag } from 'src/app/shared/models/Tag';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../food/food.service\";\nexport class TagsService {\n  constructor(foodService) {\n    this.foodService = foodService;\n    this.foodItems = [];\n    this.tagMap = new Map();\n    this.tags = [];\n    this.tagNames = ['All', 'NonVeg', 'Veg', 'South Indian', 'Birthday'];\n    this.currentTag = '';\n  }\n\n  ngOnInit() {\n    // this.getAllTags();\n    this.currentTag = 'All';\n  }\n\n  getAllTags() {\n    var _this = this;\n\n    return _asyncToGenerator(function* () {\n      // Admins will allow some mostly searched tags: eg show the mostly searched 5 tags\n      // Solely on the discretionary of the admins:\n      _this.tags = [];\n\n      _this.tagMap.clear();\n\n      _this.foodItems = [];\n      yield _this.foodService.getAllFoodItemsSync().then(resp => {\n        _this.foodItems = resp;\n      });\n      console.log(_this.foodItems);\n\n      for (let food of _this.foodItems) {\n        for (let tag of food.tags) {\n          let val = _this.tagMap.get(tag.toLowerCase().replace(/\\s+/g, \"\"));\n\n          if (val == undefined || val == null) val = 0;\n\n          _this.tagMap.set(tag.toLowerCase().replace(/\\s+/g, \"\"), val + 1);\n        }\n      }\n\n      console.log(_this.tagMap);\n\n      for (let tagName of _this.tagNames) {\n        let tag = new Tag();\n        tag['name'] = tagName;\n\n        let tagCount = _this.tagMap.get(tagName.toLowerCase().replace(/\\s+/g, \"\"));\n\n        if (tagCount == null || tagCount == undefined) tagCount = 0;\n        if (tagName == 'All') tagCount = _this.foodItems.length;\n        tag['count'] = tagCount;\n        if (tagCount > 0) _this.tags.push(tag);\n      }\n\n      console.log(_this.tags);\n      return _this.tags;\n    })();\n  }\n\n  getFoodByTag() {}\n\n}\n\nTagsService.ɵfac = function TagsService_Factory(t) {\n  return new (t || TagsService)(i0.ɵɵinject(i1.FoodService));\n};\n\nTagsService.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n  token: TagsService,\n  factory: TagsService.ɵfac,\n  providedIn: 'root'\n});","map":{"version":3,"mappings":";AACA,SAASA,GAAT,QAAoB,2BAApB;;;AAOA,OAAM,MAAOC,WAAP,CAAkB;EAEtBC,YAAoBC,WAApB,EAA6C;IAAzB;IACpB,iBAAmB,EAAnB;IACA,cAAQ,IAAIC,GAAJ,EAAR;IACA,YAAY,EAAZ;IACA,gBAAmB,CAAC,KAAD,EAAO,QAAP,EAAgB,KAAhB,EAAsB,cAAtB,EAAqC,UAArC,CAAnB;IACA,kBAAW,EAAX;EALkD;;EAMlDC,QAAQ;IACN;IACA,KAAKC,UAAL,GAAgB,KAAhB;EACD;;EAEKC,UAAU;IAAA;;IAAA;MACd;MACA;MACA,KAAI,CAACC,IAAL,GAAU,EAAV;;MACA,KAAI,CAACC,MAAL,CAAYC,KAAZ;;MACA,KAAI,CAACC,SAAL,GAAe,EAAf;MACA,MAAM,KAAI,CAACR,WAAL,CAAiBS,mBAAjB,GAAuCC,IAAvC,CAA6CC,IAAD,IAAQ;QACxD,KAAI,CAACH,SAAL,GAAeG,IAAf;MACD,CAFK,CAAN;MAIAC,OAAO,CAACC,GAAR,CAAY,KAAI,CAACL,SAAjB;;MAEA,KAAI,IAAIM,IAAR,IAAgB,KAAI,CAACN,SAArB,EAA+B;QAC7B,KAAI,IAAIO,GAAR,IAAeD,IAAI,CAACT,IAApB,EAAyB;UAEvB,IAAIW,GAAG,GAAE,KAAI,CAACV,MAAL,CAAYW,GAAZ,CAAgBF,GAAG,CAACG,WAAJ,GAAkBC,OAAlB,CAA0B,MAA1B,EAAkC,EAAlC,CAAhB,CAAT;;UACA,IAAGH,GAAG,IAAEI,SAAL,IAAkBJ,GAAG,IAAE,IAA1B,EAA+BA,GAAG,GAAC,CAAJ;;UAC/B,KAAI,CAACV,MAAL,CAAYe,GAAZ,CAAgBN,GAAG,CAACG,WAAJ,GAAkBC,OAAlB,CAA0B,MAA1B,EAAkC,EAAlC,CAAhB,EAAuDH,GAAG,GAAC,CAA3D;QAED;MACF;;MAEDJ,OAAO,CAACC,GAAR,CAAY,KAAI,CAACP,MAAjB;;MAEA,KAAI,IAAIgB,OAAR,IAAmB,KAAI,CAACC,QAAxB,EAAiC;QAC/B,IAAIR,GAAG,GAAC,IAAIlB,GAAJ,EAAR;QACAkB,GAAG,CAAC,MAAD,CAAH,GAAYO,OAAZ;;QACA,IAAIE,QAAQ,GAAC,KAAI,CAAClB,MAAL,CAAYW,GAAZ,CAAgBK,OAAO,CAACJ,WAAR,GAAsBC,OAAtB,CAA8B,MAA9B,EAAsC,EAAtC,CAAhB,CAAb;;QACA,IAAGK,QAAQ,IAAE,IAAV,IAAkBA,QAAQ,IAAEJ,SAA/B,EAAyCI,QAAQ,GAAC,CAAT;QACzC,IAAGF,OAAO,IAAE,KAAZ,EAAkBE,QAAQ,GAAC,KAAI,CAAChB,SAAL,CAAeiB,MAAxB;QAElBV,GAAG,CAAC,OAAD,CAAH,GAAaS,QAAb;QACA,IAAGA,QAAQ,GAAC,CAAZ,EAAc,KAAI,CAACnB,IAAL,CAAUqB,IAAV,CAAeX,GAAf;MACf;;MACDH,OAAO,CAACC,GAAR,CAAY,KAAI,CAACR,IAAjB;MAEA,OAAO,KAAI,CAACA,IAAZ;IApCc;EAqCf;;EAGDsB,YAAY,IAEX;;AAvDqB;;;mBAAX7B,aAAW8B;AAAA;;;SAAX9B;EAAW+B,SAAX/B,WAAW;EAAAgC,YAFV","names":["Tag","TagsService","constructor","foodService","Map","ngOnInit","currentTag","getAllTags","tags","tagMap","clear","foodItems","getAllFoodItemsSync","then","resp","console","log","food","tag","val","get","toLowerCase","replace","undefined","set","tagName","tagNames","tagCount","length","push","getFoodByTag","i0","factory","providedIn"],"sourceRoot":"","sources":["C:\\Users\\Asus\\Desktop\\Tomato\\src\\app\\services\\tags\\tags.service.ts"],"sourcesContent":["import { Injectable, OnInit } from '@angular/core';\nimport { Tag } from 'src/app/shared/models/Tag';\nimport { FoodService } from '../food/food.service';\nimport { Food } from 'src/app/shared/models/food';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class TagsService implements OnInit{\n\n  constructor(private foodService : FoodService) { }\n  foodItems:Food[] = [];\n  tagMap =new Map<string, number>();\n  tags: Tag[]=[];\n  tagNames: string[]=['All','NonVeg','Veg','South Indian','Birthday'];\n  currentTag='';\n  ngOnInit(): void {\n    // this.getAllTags();\n    this.currentTag='All';\n  }\n\n  async getAllTags(){\n    // Admins will allow some mostly searched tags: eg show the mostly searched 5 tags\n    // Solely on the discretionary of the admins:\n    this.tags=[];\n    this.tagMap.clear();\n    this.foodItems=[];\n    await this.foodService.getAllFoodItemsSync().then((resp)=>{\n      this.foodItems=resp;\n    })\n\n    console.log(this.foodItems);\n    \n    for(let food of this.foodItems){\n      for(let tag of food.tags){\n\n        let val= this.tagMap.get(tag.toLowerCase().replace(/\\s+/g, \"\"));\n        if(val==undefined || val==null)val=0;\n        this.tagMap.set(tag.toLowerCase().replace(/\\s+/g, \"\"), val+1);\n\n      }\n    }\n\n    console.log(this.tagMap);\n\n    for(let tagName of this.tagNames){\n      let tag=new Tag();\n      tag['name']=tagName;\n      let tagCount=this.tagMap.get(tagName.toLowerCase().replace(/\\s+/g, \"\"));\n      if(tagCount==null || tagCount==undefined)tagCount=0;\n      if(tagName=='All')tagCount=this.foodItems.length;\n\n      tag['count']=tagCount;\n      if(tagCount>0)this.tags.push(tag);\n    }\n    console.log(this.tags);\n    \n    return this.tags;\n  }\n\n\n  getFoodByTag(){\n\n  }\n}\n"]},"metadata":{},"sourceType":"module"}